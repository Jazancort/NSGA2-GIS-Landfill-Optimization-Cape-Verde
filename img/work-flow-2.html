<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Methodology Workflow</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #fff;
        margin: 0;
        padding: 20px;
        box-sizing: border-box;
      }
      svg {
        width: 100%;
        max-width: 950px; /* Adjusted max-width for the new layout */
        height: auto;
        overflow: visible !important;
      }
      .node-rect {
        stroke-width: 1.5;
        stroke: #2d3142;
        rx: 8;
        ry: 8;
        filter: drop-shadow(0px 3px 3px rgba(0, 0, 0, 0.1));
      }
      .node-text {
        font-size: 14px;
        font-weight: 500;
        fill: #212529;
        text-anchor: middle;
        pointer-events: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
      .node-text-light {
        fill: white;
        font-weight: 600;
      }
      .arrow-line {
        stroke: #4f5d75;
        stroke-width: 2;
        fill: none;
      }
      .arrow-text {
        font-size: 12px;
        font-weight: 500;
        fill: #4f5d75;
        text-anchor: middle;
        background: white;
        paint-order: stroke fill;
        stroke: white;
        stroke-width: 3;
        stroke-linejoin: round;
      }
      .phase-title {
        font-size: 18px;
        font-weight: bold;
        text-anchor: middle;
        fill: #003049;
        z-index: 10000000;
      }
      /* Color Scheme */
      .color-phase1 {
        fill: #caf0f8;
      }
      .color-phase2 {
        fill: #90e0ef;
      }
      .color-phase3 {
        fill: #48cae4;
      }
      .color-phase4 {
        fill: #00b4d8;
      }
      .color-start {
        fill: #0077b6;
      }
      .color-end {
        fill: #023e8a;
      }
      .color-data {
        fill: #4dfed1;
        stroke-dasharray: 5 3;
      }
    </style>
  </head>
  <body>
    <svg
      id="workflow-svg"
      viewBox="0 0 950 1100"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <marker
          id="arrowhead"
          markerWidth="8"
          markerHeight="6"
          refX="7"
          refY="3"
          orient="auto"
          markerUnits="strokeWidth"
        >
          <polygon points="0 0, 8 3, 0 6" fill="#4f5d75" />
        </marker>
      </defs>

      <!-- COLUMN 1 (LEFT) -->
      <!-- Phase 1 Title -->
      <text x="225" y="40" class="phase-title">
        1. Data Input & Candidate Generation
      </text>

      <!-- Phase 1 nodes -->
      <g id="node-A" transform="translate(150, 80)">
        <rect class="node-rect color-start" width="150" height="70" />
        <text class="node-text node-text-light" x="75" y="40">Input Data</text>
      </g>
      <g id="node-B" transform="translate(150, 180)">
        <rect class="node-rect color-phase1" width="150" height="70" />
        <text class="node-text" x="75" y="32">Generate 1kmÂ²</text>
        <text class="node-text" x="75" y="48">Grid of Areas</text>
      </g>
      <g id="node-C" transform="translate(150, 280)">
        <rect class="node-rect color-phase1" width="150" height="70" />
        <text class="node-text" x="75" y="32">Select 524 Areas</text>
        <text class="node-text" x="75" y="48">Intersecting Island</text>
      </g>
      <g id="node-D" transform="translate(150, 380)">
        <rect class="node-rect color-phase1" width="150" height="70" />
        <text class="node-text" x="75" y="32">Calculate Centroid</text>
        <text class="node-text" x="75" y="48">for each Area</text>
      </g>
      <g id="node-E" transform="translate(150, 480)">
        <rect class="node-rect color-data" width="150" height="70" />
        <text class="node-text" x="75" y="32">524 Candidate</text>
        <text class="node-text" x="75" y="48">Points (lat, lon)</text>
      </g>

      <!-- Phase 2 Title -->

      <text x="225" y="600" class="phase-title">2. Criteria Analysis</text>
      <path
        d="M 232 550 V 635"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />

      <!-- Phase 2 nodes -->
      <g id="node-F" transform="translate(150, 640)">
        <rect class="node-rect color-phase2" width="150" height="70" />
        <text class="node-text" x="75" y="40">Loop through</text>
      </g>
      <g id="node-G" transform="translate(150, 740)">
        <rect class="node-rect color-phase2" width="150" height="70" />
        <text class="node-text" x="75" y="40">Criteria Calculation</text>
      </g>
      <g id="node-H" transform="translate(50, 840)">
        <rect class="node-rect color-phase2" width="150" height="70" />
        <text class="node-text" x="75" y="32">Raster Analysis</text>
        <text class="node-text" x="75" y="48">(Slope, Aspect)</text>
      </g>
      <g id="node-I" transform="translate(250, 840)">
        <rect class="node-rect color-phase2" width="150" height="70" />
        <text class="node-text" x="75" y="32">Vector Analysis</text>
        <text class="node-text" x="75" y="48">(Distances)</text>
      </g>
      <g id="node-J" transform="translate(150, 940)">
        <rect class="node-rect color-phase2" width="150" height="70" />
        <text class="node-text" x="75" y="32">OSM Analysis</text>
        <text class="node-text" x="75" y="48">(Distances)</text>
      </g>
      <g id="node-K" transform="translate(150, 1040)">
        <rect class="node-rect color-data" width="150" height="70" />
        <text class="node-text" x="75" y="32">Raw Criteria</text>
        <text class="node-text" x="75" y="48">DataFrame</text>
      </g>

      <!-- COLUMN 2 (RIGHT) -->
      <!-- Phase 3 Title -->
      <text x="575" y="40" class="phase-title">
        3. Multi-Objective Optimization
      </text>

      <!-- Phase 3 nodes -->
      <g id="node-M" transform="translate(500, 80)">
        <rect class="node-rect color-phase3" width="150" height="70" />
        <text class="node-text" x="75" y="32">Define Objective</text>
        <text class="node-text" x="75" y="48">Functions</text>
      </g>
      <g id="node-N" transform="translate(500, 180)">
        <rect class="node-rect color-phase3" width="150" height="70" />
        <text class="node-text" x="75" y="32">Run NSGA-II</text>
        <text class="node-text" x="75" y="48">Algorithm</text>
      </g>
      <g id="node-O" transform="translate(500, 280)">
        <rect class="node-rect color-data" width="150" height="70" />
        <text class="node-text" x="75" y="32">Pareto Front</text>
        <text class="node-text" x="75" y="48">(14 Optimal Solutions)</text>
      </g>
      <!-- Moved to the side as a final output of this phase -->
      <!-- <g id="node-L" transform="translate(700, 280)">
        <rect class="node-rect color-end" width="150" height="70" />
        <text class="node-text node-text-light" x="75" y="32">Save to</text>
        <text class="node-text node-text-light" x="75" y="48">
          criteria_data.csv
        </text>
      </g> -->

      <!-- Phase 4 Title -->
      <text x="575" y="400" class="phase-title">4. Decision Making</text>

      <!-- Phase 4 nodes -->
      <g id="node-P" transform="translate(500, 440)">
        <rect class="node-rect color-phase4" width="150" height="70" />
        <text class="node-text" x="75" y="32">Analyze Extreme</text>
        <text class="node-text" x="75" y="48">Solutions</text>
      </g>
      <g id="node-Q" transform="translate(500, 540)">
        <rect class="node-rect color-phase4" width="150" height="70" />
        <text class="node-text" x="75" y="32">Select Best</text>
        <text class="node-text" x="75" y="48">Compromise</text>
      </g>
      <g id="node-R" transform="translate(500, 640)">
        <rect class="node-rect color-end" width="150" height="70" />
        <text class="node-text node-text-light" x="75" y="40">
          Final Report
        </text>
      </g>

      <!-- CONNECTIONS -->
      <!-- Phase 1 connections -->
      <path
        d="M 225 150 V 175"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 250 V 275"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 350 V 375"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 450 V 475"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />

      <!-- Phase 2 connections -->
      <path
        d="M 225 710 V 735"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <!-- Branching from G to H, I, J -->
      <path
        d="M 225 810 V 820 H 125 V 835"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 810 V 820 H 325 V 835"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 810 V 935"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <!-- Converging to K -->
      <path
        d="M 125 910 V 1020 H 225 V 1035"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 325 910 V 1020 H 225 V 1035"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 225 1010 V 1035"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />

      <!-- Phase 3 connections -->
      <path
        d="M 575 150 V 175"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 575 250 V 275"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <!-- From O to L (side output) -->
      <!-- <path
        d="M 650 315 H 695"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      /> -->

      <!-- Phase 4 connections -->
      <path
        d="M 575 510 V 535"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <path
        d="M 575 610 V 635"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />

      <!-- Inter-phase connections -->
      <!-- From Phase 2 (K) to Phase 3 (M) -->
      <path
        d="M 300 1075 H 425 V 115 H 500"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
      <!-- From Phase 3 (O) to Phase 4 (P) -->
      <path
        d="M 589 350 V 435"
        class="arrow-line"
        marker-end="url(#arrowhead)"
      />
    </svg>
  </body>
</html>
